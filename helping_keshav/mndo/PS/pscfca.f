C     ******************************************************************
C
C     Alternative access to SCF calculations in the context
C     of approximate numerical differentiation.
C
C     ******************************************************************
      SUBROUTINE PSCFCA (A,LM5,DUMP)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C     *
C     SCF CALCULATION WITH APPROXIMATE EXTRAPOLATED INTEGRALS.
C     USEFUL ONLY FOR CONSISTENCY CHECKS AND CODE DEVELOPMENT.
C     DENSITY MATRIX ALWAYS AVAILABLE WHEN CALLING PCSCFA.
C     *
C     COSMO CALCULATIONS ARE NOT SUPPORTED BECAUSE THEY REQUIRE THE
C     DIELECTRIC MATRIX AC(LCD1) FOR CALLING ADDFCK IN SUBROUTINE ITER.
C     THE ARGUMENT AC(LCD1) HAS FORMALLY BEEN REPLACED BY ARGUMENT A
C     IN THE CALL TO SUBROUTINE ITER (END OF SECOND LINE) BUT WILL NOT
C     BE ACCESSED SINCE ICOSMO=IN2(28)=0 IS ENFORCED.
C     *
      LOGICAL NOPRT,PRT
      COMMON
     ./CONSTF/ A0,AFACT,EV,EVCAL,PI,W1,W2,BIGEXP
     ./DENERG/ DENER
     ./ENERGT/ EE,ENUCLR,EAT,ATHEAT
     ./MMCOM1/ EMM
     ./MMDP  / EMMDP
     ./CHCORR/ EHCORR
     ./INOPT2/ IN2(300)
     ./LIMITS/ LM2,LM3,LM4,LM6,LM7,LM8,LM9
     ./LMCSM2/ LMCA1,LMCB1,LMCC1,LMCD1,LMCTOT,LMQ,NPS
     ./LMSCF / LS1,LS2,LS3,LS4,LS5,LS6,LS7,LS8,LS9
     ./LMUHF / LU1,LU2,LU3,LU4,LU5,LU6,LU7,LU8
     ./ORBITS/ NUMB,NORBS,NMOS,NALPHA,NBETA
      DIMENSION A(LM5)
      DIMENSION DUMP(*)
C *** APPROXIMATE TWO-CENTER INTEGRALS.
C     EVALUATED BY EXTRAPOLATION USING AVAILABLE NUMERICAL DERIVATIVES.
      WRITE(6,*) ' PSCFCA 1'
      CALL PSCORE (A(LS7),A(LS9),LM4,LM9,DUMP)
      WRITE(6,*) ' PSCFCA 2'
C *** SET OPTIONS.
      ICALL  = 0
      ICOSMO = IN2(28)
      NPRINT = IN2(72)
      IATERG = IN2(119)
      NOPRT  = NPRINT.LT.5
      PRT    = .NOT.NOPRT
C *** SCF PROCEDURE.
      IF(ICOSMO.GT.0) IN2(28)=0
      NROOT  = LM3
      IF(NOPRT) NROOT=NMOS
      CALL ITER (A(LS1),A(LU1),A(LS5),A(LU5),A(LS2),A(LU2),A(LS6),
     1           A(LU6),A(LS7),A(LS8),A(LU8),A(LS3),A(LS9),A,
     2           LM2,LM3,LM4,LM6,LM9,LMCD1,LMQ,NROOT,NOPRT,ICALL)
      WRITE(6,*) ' PSCFCA 3'
      IF(PRT) THEN
         CALL PRTSCF (A(LS1),A(LU1),A(LS2),A(LU2),A(LS6),A(LU6),
     1                A(LS7),A(LS8),A(LU8),LM2,LM3,LM4)
         CALL DIPOLE (A(LS8),A(LU8),LM4,PRT)
      ENDIF
      IF(ICOSMO.GT.0) IN2(28)=ICOSMO
C *** SCF HEAT OF FORMATION.
      IF(IATERG.EQ.1) THEN
         DENER = ATHEAT+EVCAL*(EE+ENUCLR-EAT)+EMM+EMMDP+EHCORR
      ELSEIF(IATERG.EQ.-1) THEN
         DENER = EVCAL*(EE+ENUCLR)+EMM+EMMDP+EHCORR
      ENDIF
      RETURN
      END
