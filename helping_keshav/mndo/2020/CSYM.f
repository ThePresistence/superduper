      SUBROUTINE CSYM (C,NFIRST,NLAST,ISYM,LM2,NUMAT,M,IEL,ISS,IER)
C     *
C     SYMMETRY ASSIGNMENT OF MOLECULAR ORBITAL EIGENVECTORS C(LM2)
C     WITH RESPECT TO A SYMMETRY ELEMENT.
C     *
C     ORDER OF SYMMETRY OPERATIONS: YZ, XZ, XY, X, Y, Z, I.
C     ORDER OF ATOMIC ORBITALS: s, x, y, z, x2-y2, xz, z2, yz, xy.
C     *
C     NOTATION. I=INPUT, O=OUTPUT.
C     C(LM2)    MO COEFFICIENTS (I).
C     NFIRST()  INDEX OF FIRST ORBITAL AT A GIVEN ATOM (I).
C     NLAST()   INDEX OF LAST  ORBITAL AT A GIVEN ATOM (I).
C     ISYM(3,*) PERMUTED TABLE OF ATOM NUMBERS AFTER APPLYING
C               THE CORRESPONDING SYMMETRY OPERATIONS (I).
C     NUMAT     NUMBER OF ATOMS (I).
C     M         INDEX OF CURRENT SYMMETRY ELEMENT (I) IN ISYM(M,*).
C     IEL       LABEL OF CURRENT SYMMETRY ELEMENT (I) FROM ASSYM.
C     ISS       CLASSIFICATION OF EIGENVECTOR (O).
C               = 0 IMPOSSIBLE.
C               =-1 ANTISYMMETRIC.
C               = 1 SYMMETRIC.
C     IER       ERROR FLAG (O).
C               = 0 NO ERROR.
C               = 1 ASSIGNMENT IMPOSSIBLE (ISS=0).
C     *
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      DIMENSION C(LM2),NFIRST(NUMAT),NLAST(NUMAT),ISYM(3,NUMAT)
      DATA SMALL/1.0D-03/
      IER    = 0
C *** LOOP OVER ATOMS.
      DO 10 I=1,NUMAT
      KA     = NFIRST(I)
      KB     = NLAST(I)
      J      = ISYM(M,I)
C     CASE 1. ATOM I LIES IN THE SYMMETRY ELEMENT.
      IF(I.NE.J) GO TO 30
      DO 20 K=KA,KB
      IF(ABS(C(K)).LT.SMALL) GO TO 20
      KK     = K-KA+1
      GO TO (21,22,23,24,25,26,27,27,27),IEL
   21 GO TO (100,110,100,100,100,110,100,100,110),KK
   22 GO TO (100,100,110,100,100,100,100,110,110),KK
   23 GO TO (100,100,100,110,100,110,100,110,100),KK
   24 GO TO (100,100,110,110,100,110,100,100,110),KK
   25 GO TO (100,110,100,110,100,100,100,110,110),KK
   26 GO TO (100,110,110,100,100,110,100,110,100),KK
   27 GO TO (100,110,110,110,100,100,100,100,100),KK
   20 CONTINUE
      GO TO 10
C     CASE 2. ATOM I IS RELATED TO ATOM J BY SYMMETRY.
   30 LA     = NFIRST(J)
      DO 40 K=KA,KB
      IF(ABS(C(K)).LT.SMALL) GO TO 40
      KK     = K-KA+1
      L      = K-KA+LA
      IF(ABS(C(K)-C(L)).GT.SMALL) GO TO 50
      GO TO (41,42,43,44,45,46,47,47,47),IEL
   41 GO TO (100,110,100,100,100,110,100,100,110),KK
   42 GO TO (100,100,110,100,100,100,100,110,110),KK
   43 GO TO (100,100,100,110,100,110,100,110,100),KK
   44 GO TO (100,100,110,110,100,110,100,100,110),KK
   45 GO TO (100,110,100,110,100,100,100,110,110),KK
   46 GO TO (100,110,110,100,100,110,100,110,100),KK
   47 GO TO (100,110,110,110,100,100,100,100,100),KK
   50 IF(ABS(C(K)+C(L)).GT.SMALL) GO TO 120
      GO TO (51,52,53,54,55,56,57,57,57),IEL
   51 GO TO (110,100,110,110,110,100,110,110,100),KK
   52 GO TO (110,110,100,110,110,110,110,100,100),KK
   53 GO TO (110,110,110,100,110,100,110,100,110),KK
   54 GO TO (110,110,100,100,110,100,110,110,100),KK
   55 GO TO (110,100,110,100,110,110,110,100,100),KK
   56 GO TO (110,100,100,110,110,100,110,100,110),KK
   57 GO TO (110,100,100,100,110,110,110,110,110),KK
   40 CONTINUE
   10 CONTINUE
      GO TO 120
C *** ASSIGNMENT OF SYMMETRY LABEL.
  100 ISS    = 1
      RETURN
  110 ISS    =-1
      RETURN
C *** ERROR EXIT.
  120 IER    = 1
      ISS    = 0
      RETURN
      END
