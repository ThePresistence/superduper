      SUBROUTINE INPANA (JPRINT)
C     *
C     INPUT OF SPECIFIC OPTIONS FOR ANALYTICAL DERIVATIVES.
C     *
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
CSET  NUMBER OF EXTERNAL STORAGE UNITS NEEDED TO STORE ONE
CSET  DOUBLE PRECISION WORD ON A DIRECT ACCESS FILE.
CSET  USED ONLY IN THE ANALYTICAL DERIVATIVE CODE.
CSET  MACHINE-SPECIFIC VALUE WHICH MAY BE REDEFINED.
CSET  DEFAULT: USE BYTES AS UNITS.
      PARAMETER (DSTORE=8.0D0)
      COMMON
     ./INOPT1/ IN1(300)
     ./INOPT2/ IN2(300)
     ./INOPT3/ XN3(50)
     ./INOPT4/ XN4(50)
     ./MOPAC / IMOPAC
     ./NBFILE/ NBF(20)
     ./PSDOPT/ RPSOPT(10),IPSOPT(28)
C *** FILE NUMBERS.
      NB5    = NBF(5)
      NB6    = NBF(6)
C *** INPUT VARIABLES.
      NMR    = IN2(13)
      IPSANA = IN2(29)
      IPSABS = ABS(IPSANA)
C *** READ INPUT AND INITIALIZE ARRAYS.
      IF(IMOPAC.EQ.0) THEN
         IF(IPSABS.GE.2 .OR. NMR.GT.10 .OR. NMR.LT.-1) THEN
            READ(NB5,500) (IN1(I),I=90,118)
            READ(NB5,510) (XN3(I),I=8,15)
         ELSE
            IN1(90:118) = 0
            XN3(8:15)   = 0.D0
         ENDIF
      ENDIF
      IN2(90:118) = IN1(90:118)
      XN4(8:15)   = XN3(8:15)
      IF(IPSANA.LT.0 .AND. NMR.EQ.0) RETURN
C *** SET DEFAULT VALUES FOR NMR (INDSYM,NMRLEV,INTCTL,INCOFF,NMRNUC).
      IF(IN2( 96).EQ. 0 .AND. NMR.NE.0) IN2(96)=2
      IF(IN2(115).LE. 0) IN2(115)=3
      IF(IN2(116).LE. 0) IN2(116)=14
      IF(IN2(116).EQ.10) IN2(116)=14
      IF(IN2(117).EQ. 0) IN2(117)=6
      IF(IN2(118).EQ. 0) IN2(118)=4
C *** DEFINE VARIABLES IN COMMON BLOCK PSDOPT.
      RPSOPT(1)    = DSTORE
      RPSOPT(2:9)  = XN4(8:15)
      IF(IN2(117).GT.0) THEN
        RPSOPT(10) = 10.0D0**(-IN2(117))
      ELSE
        RPSOPT(10) = -1.0D0
      ENDIF
      IPSOPT(1:4)  = IN2(111:114)
      IPSOPT(5:25) = IN2(90:110)
      IPSOPT(26)   = IN2(115)
      IPSOPT(27)   = IN2(116)
      IPSOPT(28)   = IN2(118)
C *** CONVERT FROM MEGABYTE TO WORDS.
      IPSOPT(7) = IPSOPT(7)*131072
      IPSOPT(8) = IPSOPT(8)*131072
C *** PRINTING SECTION.
      IF(JPRINT.GT.-5) THEN
         IF(IPSABS.GE.2 .OR. NMR.GT.10 .OR. NMR.LT.-1) THEN
            WRITE(NB6,100)
            WRITE(NB6,110) (IN2(I),I=90,118)
            WRITE(NB6,120) (XN4(I),I=8,15)
         ENDIF
      ENDIF
      RETURN
  100 FORMAT(///1X,'*** OPTIONS FOR ANALYTICAL DERIVATIVES      ***',
     1       /  1X,'*** DEFINED EITHER EXPLICITLY OR BY DEFAULT ***')
  110 FORMAT(/  1X,'IPSPRT =',I5,5X,'IENRG  =',I5,5X,'ICORE  =',I5,
     1          5X,'IDISK  =',I5,5X,'IMIX   =',I5,
     2       /  1X,'IDENS  =',I5,5X,'INDSYM =',I5,5X,'IQSWAP =',I5,
     3          5X,'IAVEIT =',I5,5X,'IMAXIT =',I5,
     4       /  1X,'INRHS  =',I5,5X,'IKRVEC =',I5,5X,'IROWS  =',I5,
     5          5X,'IPRCON =',I5,5X,'INCPUS =',I5,
     6       /  1X,'IDSTRP =',I5,5X,'IHLST  =',I5,5X,'IHLWRP =',I5,
     7          5X,'IKMODE =',I5,5X,'ISOLVE =',I5,
     8       /  1X,'IKRSAV =',I5,5X,'IUMIX  =',I5,5X,'IURHS  =',I5,
     9          5X,'IUK    =',I5,5X,'IURES  =',I5,
     A       /  1X,'NMRLEV =',I5,5X,'INTCTL =',I5,5X,'INCOFF =',I5,
     B          5X,'NMRNUC =',I5,//)
  120 FORMAT(/  1X,'DSTEP  =',G10.5,2X,'DCONV  =',G10.5,2X,
     1             'DPCONV =',G10.5,2X,'DCPHF  =',G10.5,2X,
     2             'DPREC  =',G10.5,
     3       /  1X,'DCDIFF =',G10.5,2X,'DSHIFT =',G10.5,2X,
     4             'DBASCR =',G10.5)
  500 FORMAT(4I5,5I2,I4,2I2,I4,I2,I4,5I2,I4,5I2,I4,2I2)
  510 FORMAT(8G10.5)
      END
